apiVersion: v1
kind: Pod
metadata:
  name: hadoop-sandbox-client
spec:
  containers:
  - name: main
    image: hadoop-sandbox-main
    args:
    - tail
    - -f
    - /dev/null
    envFrom:
    - configMapRef:
        name: hadoop-env
    - configMapRef:
        name: hive-env
    - configMapRef:
        name: tez-env
    env:
    - name: PATH
      value: $(HIVE_HOME)/bin:$(HADOOP_HOME)/bin:/usr/local/openjdk-8/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
    - name: HADOOP_CLASSPATH
      value: $(TEZ_CONF_DIR):$(TEZ_JARS)/*:$(TEZ_JARS)/lib/*
    securityContext:
      runAsUser: 1001
      runAsGroup: 1001
    volumeMounts:
    - name: hadoop-conf
      mountPath: /etc/hadoop/conf
    - name: hive-conf
      mountPath: /etc/hive/conf
    - name: tez-conf
      mountPath: /etc/tez/conf
    - name: package-hadoop
      mountPath: /opt/hadoop
    - name: package-hive
      mountPath: /opt/hive
    - name: package-tez
      mountPath: /opt/tez
    workingDir: /home/sandbox
  volumes:
  - name: hadoop-conf
    configMap:
      name: hadoop-conf
      items:
      - key: core-site.xml
        path: core-site.xml
      - key: log4j.properties
        path: log4j.properties
      - key: mapred-site.xml
        path: mapred-site.xml
      - key: yarn-site.xml
        path: yarn-site.xml
  - name: hive-conf
    configMap:
      name: hive-conf
      items:
      - key: beeline-hs2-connection.xml
        path: beeline-hs2-connection.xml
  - name: tez-conf
    configMap:
      name: tez-conf
      items:
      - key: tez-site.xml
        path: tez-site.xml
  - name: package-hadoop
    persistentVolumeClaim:
      claimName: package-hadoop
  - name: package-hive
    persistentVolumeClaim:
      claimName: package-hive
  - name: package-tez
    persistentVolumeClaim:
      claimName: package-tez
